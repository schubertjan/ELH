library(devtools)
playerLoad <- function(pageUrl,removeLine=TRUE) {
html <- xml2::read_html(pageUrl)
cast <- rvest::html_nodes(html, ".table-stats")
df <- rvest::html_table(cast,fill = T)
x <- df[[1]]
if(removeLine) {
colnames(x) <- x[1,]
x <- x[-1,]
x[,-c(1:6)] <- apply(x[,-c(1:6)],2,as.numeric)
x$GP <- as.numeric(x$GP)
} else (x)
x$TOI <- lubridate::ms(x$TOI)
x$minutes <- lubridate::minute(x$TOI)+(lubridate::second(x$TOI)/60)
x$downloadData <- rep(Sys.Date(),nrow(x))
x
}
teamLoad <- function(pageUrl,removeLine=TRUE) {
html <- xml2::read_html(pageUrl)
cast <- rvest::html_nodes(html, ".table-stats")
df <- rvest::html_table(cast,fill = T)
x <- df[[1]]
if(removeLine) {
colnames(x) <- x[1,]
x <- x[-1,]
x[,-c(1:2)] <- apply(x[,-c(1:2)],2,as.numeric)
} else (x)
x$downloadData <- rep(Sys.Date(),nrow(x))
x
}
### team ###
strelyTeam <- teamLoad("http://hokej.cz/tipsport-extraliga/stats-center/team-analytic-stats?season=2017&competition=6026")
corsiTeam <- teamLoad(removeLine = F,"http://hokej.cz/tipsport-extraliga/stats-center/team-analytic-stats?season=2017&competition=6026&stats-section=corsi")
presilovkyTeam <- teamLoad("http://hokej.cz/tipsport-extraliga/stats-center/team-stats?season=2017&competition=6026&stats-section=powerplay")
html <- xml2::read_html("http://hokej.cz/tipsport-extraliga/table?table-filter-season=2017&table-filter-competition=6026")
cast <- rvest::html_nodes(html, ".table-soupiska")
df <- rvest::html_table(cast,fill = T)
bodyTeam <- df[[1]]
colnames(bodyTeam) <- toupper(colnames(bodyTeam))
tymy <- merge(strelyTeam,corsiTeam,by="TÝM")
tymy <- merge(tymy,presilovkyTeam,by="TÝM")
tymy <- merge(tymy,bodyTeam[,c(1:2,9)],by="TÝM")
tymy <- tymy[,-c(grep("PO",names(tymy),ignore.case = T))]
colnames(tymy)[32] <- "Rank"
colnames(tymy) <- iconv(colnames(tymy), to='ASCII//TRANSLIT')
colnames(tymy) <- gsub("%","pr",colnames(tymy))
colnames(tymy) <- gsub("[/]","per",colnames(tymy))
library(caret)
nzv <- nearZeroVar(tymy)
rownames(tymy) <- tymy[,1]
tymyClean <- tymy[,-c(1,nzv)]
View(tymyClean)
?use_data
teams2017_2018 <- tymyClean
use_data(teams2017_2018,ELH)
use_data(teams2017_2018,"ELH")
setwd("./cats")
document()
library(devtools)
document()
